# Тесты валидации адресов

Этот набор тестов предназначен для проверки корректности работы валидации адресов, особенно для случаев, когда номер улицы может быть ошибочно принят за номер дома.

## Проблема

Адрес "ул 22 Партсъезда" проходил валидацию, потому что регулярное выражение `/\d/` находило цифру "22", но это номер улицы, а не номер дома.

## Решение

Улучшенная валидация использует данные от DaData API для точного определения наличия номера дома в адресе.

## Запуск тестов

### Быстрый запуск
```bash
./run_address_tests.sh
```

### Ручной запуск
```bash
npm run dev
# Открыть в браузере: http://localhost:5173/test
```

## Типы тестов

### 1. Быстрый тест
- Ручной ввод адреса
- Проверка в реальном времени
- Список проблемных адресов для быстрого тестирования

### 2. Мок-тесты
- Симуляция разных сценариев валидации
- Проверка логики без реальных API вызовов
- Статистика прохождения тестов

### 3. DaData тесты
- Реальная проверка через DaData API
- Детальный анализ ответов API
- Сравнение ожидаемых и фактических результатов

## Тестовые случаи

### Корректные адреса (должны проходить)
- `ул Ленина 15` - Улица + номер дома
- `пр. Мира 25а` - Проспект + номер дома с буквой
- `пер. Садовый 8/2` - Переулок + дробный номер дома
- `ул 8 Марта 15` - Улица с номером + номер дома

### Проблемные адреса (не должны проходить)
- `ул 22 Партсъезда` - Улица с номером 22 (без дома)
- `1-й ул. Май` - Первая улица Май
- `ул Ленина` - Улица без номера дома

### Крайние случаи
- `ул. Карла Маркса, д. 25, кв. 12` - Полный адрес
- `ул. Новая, 33 корпус 2` - С корпусом
- `ул. Центральная, стр. 1` - Со строением

## Структура компонентов

- `AddressInput.jsx` - Основной компонент ввода с улучшенной валидацией
- `AddressValidationTest.jsx` - Мок-тесты для проверки логики
- `DadataAddressTest.jsx` - Реальные тесты через DaData API
- `TestPage.jsx` - Общая страница тестов с табами

## Настройка DaData

Для полноценных тестов нужен токен DaData:
1. Зарегистрируйтесь на https://dadata.ru
2. Получите API токен
3. Введите его в поле "DaData Token" на вкладке "DaData тесты"

## Ожидаемые результаты

После исправления валидации:
- Адрес "ул 22 Партсъезда" не должен проходить валидацию
- Адреса с реальными номерами домов должны проходить
- Система должна использовать данные DaData для точной проверки

## Статистика тестов

Тесты показывают:
- Общее количество тестов
- Количество пройденных/проваленных
- Процент успешности
- Ошибки API (если есть)

## Автоматизация

Скрипт `run_address_tests.sh` автоматически:
- Запускает dev сервер
- Открывает тестовую страницу
- Предоставляет инструкции по использованию
